<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Execora - Voice Business Assistant (Audio Enabled)</title>
    <link rel="stylesheet" href="/css/styles.css">
    <script>
        (function () {
            var savedTheme = localStorage.getItem('theme');
            if (savedTheme === 'light' || savedTheme === 'dark') {
                document.documentElement.setAttribute('data-theme', savedTheme);
            } else {
                document.documentElement.setAttribute('data-theme', 'dark');
            }
        })();
    </script>
</head>
<body>
    <!-- Header -->
    <header class="chat-header">
        <div class="ui-version-switcher-new">
            <button id="uiSwitcherBtn" class="ui-switch-btn-new" title="Switch to Stable UI">
                ⚙️ Stable UI
            </button>
        </div>
        <div class="header-content">
            <div class="header-left">
                <button id="sidebarToggle" class="sidebar-toggle-btn" type="button" aria-label="Toggle sidebar">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <line x1="3" y1="12" x2="21" y2="12"></line>
                        <line x1="3" y1="6" x2="21" y2="6"></line>
                        <line x1="3" y1="18" x2="21" y2="18"></line>
                    </svg>
                </button>
                <div class="brand">
                    <div class="brand-icon">Execora</div>
                </div>
            </div>
            <div class="header-actions">
                <span class="status-indicator" id="statusIndicator">
                    <span class="status-dot"></span>
                    <span id="statusText">Disconnected</span>
                </span>
                <button id="themeToggleBtn" class="theme-toggle-btn" type="button" aria-label="Toggle theme">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
    </header>

    <!-- Main Layout with Sidebar -->
    <div class="main-layout">
        <!-- Left Sidebar -->
        <aside id="sidebar" class="sidebar">
            <div class="sidebar-content">
                <div class="sidebar-section">
                    <h3 class="sidebar-title">Settings</h3>
                    
                    <div class="setting-group">
                        <label class="setting-label">Speech Output</label>
                        <select id="ttsProvider" class="sidebar-select">
                            <option value="browser">Browser Speech (Free)</option>
                            <option value="openai">OpenAI TTS (Premium)</option>
                            <option value="elevenlabs">ElevenLabs TTS (Premium)</option>
                        </select>
                        <p class="setting-description">Choose how AI responses are spoken</p>
                    </div>

                    <div class="setting-group">
                        <div class="connection-status">
                            <label class="setting-label">Connection</label>
                            <div class="connection-details">
                                <small id="connectionInfo">Waiting to connect...</small>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Live Dashboard Panel -->
                <div class="sidebar-section">
                    <h3 class="sidebar-title">Live Dashboard</h3>
                    <div id="liveDashboard" class="live-dashboard">
                        <div class="dashboard-card">
                            <div class="dashboard-stat">
                                <span class="stat-label">Today's Sales</span>
                                <span class="stat-value" id="dashTotalSales">--</span>
                            </div>
                            <div class="dashboard-stat">
                                <span class="stat-label">Invoices</span>
                                <span class="stat-value" id="dashInvoiceCount">--</span>
                            </div>
                            <div class="dashboard-stat">
                                <span class="stat-label">Payments</span>
                                <span class="stat-value" id="dashTotalPayments">--</span>
                            </div>
                            <div class="dashboard-stat">
                                <span class="stat-label">Pending</span>
                                <span class="stat-value stat-pending" id="dashPendingAmount">--</span>
                            </div>
                        </div>

                        <div id="dashActiveCustomer" class="dashboard-active-customer" style="display: none;">
                            <span class="stat-label">Active Customer</span>
                            <div class="active-customer-info">
                                <span id="dashCustomerName">--</span>
                                <span id="dashCustomerBalance" class="customer-balance">--</span>
                            </div>
                        </div>

                        <div id="dashLowStock" class="dashboard-low-stock" style="display: none;">
                            <span class="stat-label">Low Stock Alert</span>
                            <div id="dashLowStockList" class="low-stock-list"></div>
                        </div>
                    </div>
                </div>

                <!-- Activity Log in Sidebar -->
                <div class="sidebar-section">
                    <details class="sidebar-log-toggle">
                        <summary class="sidebar-title">Activity Log</summary>
                        <div id="activityLog" class="sidebar-log">
                            <div class="log-entry">System started</div>
                        </div>
                    </details>
                </div>
            </div>
        </aside>

    <!-- Chat Container -->
    <div class="chat-container">
        <!-- Conversation Area -->
        <div class="chat-messages" id="chatMessages">
            <div class="welcome-message">
                <h2>Your AI-Powered Voice Business Operations Assistant</h2>
            </div>

            <!-- User Message (Template - will be populated by JS) -->
            <div id="userMessageContainer" class="message user-message" style="display: none;">
                <div class="message-avatar user-avatar">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
                        <circle cx="12" cy="7" r="4"></circle>
                    </svg>
                </div>
                <div class="message-content">
                    <div class="message-header">
                        <span class="message-label">You</span>
                    </div>
                    <div id="transcript" class="message-text">Your message appears here</div>
                </div>
            </div>

            <!-- AI Response (Template - will be populated by JS) -->
            <div id="aiMessageContainer" class="message ai-message" style="display: none;">
                <div class="message-avatar ai-avatar">
                    <div class="ai-icon">E</div>
                </div>
                <div class="message-content">
                    <div class="message-header">
                        <span class="message-label">Execora</span>
                    </div>
                    <div id="response" class="message-text">AI response appears here</div>
                </div>
            </div>
        </div>

        <!-- Input Controls at Bottom -->
        <div class="chat-input-area">
            <!-- Voice Visualizer -->
            <div class="voice-section">
                <div id="audioVisualizer" class="audio-visualizer" aria-label="Live voice visualizer"></div>
            </div>

            <!-- Input Row -->
            <div class="input-row">
                <input 
                    type="text" 
                    id="textInput" 
                    class="chat-input" 
                    placeholder="Message Execora..."
                    disabled
                >
                <button id="startVoiceBtn" class="icon-btn voice-btn" disabled title="Start voice">
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M12 1a3 3 0 0 0-3 3v8a3 3 0 0 0 6 0V4a3 3 0 0 0-3-3z"></path>
                        <path d="M19 10v2a7 7 0 0 1-14 0v-2"></path>
                        <line x1="12" y1="19" x2="12" y2="23"></line>
                        <line x1="8" y1="23" x2="16" y2="23"></line>
                    </svg>
                </button>
                <button id="stopVoiceBtn" class="icon-btn stop-btn" disabled title="Stop voice" style="display: none;">
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor">
                        <rect x="6" y="6" width="12" height="12" rx="2"></rect>
                    </svg>
                </button>
                <button id="sendTextBtn" class="icon-btn send-btn" disabled title="Send message">
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <line x1="22" y1="2" x2="11" y2="13"></line>
                        <polygon points="22 2 15 22 11 13 2 9 22 2"></polygon>
                    </svg>
                </button>
            </div>
        </div>
    </div>
    </div>

    <!-- Use audio-enabled version -->
    <script>
        (function () {
            var themeToggleBtn = document.getElementById('themeToggleBtn');
            if (!themeToggleBtn) return;

            function updateIcon(theme) {
                var sunIcon = '<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="5"></circle><line x1="12" y1="1" x2="12" y2="3"></line><line x1="12" y1="21" x2="12" y2="23"></line><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line><line x1="1" y1="12" x2="3" y2="12"></line><line x1="21" y1="12" x2="23" y2="12"></line><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line></svg>';
                var moonIcon = '<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path></svg>';
                themeToggleBtn.innerHTML = theme === 'dark' ? sunIcon : moonIcon;
            }

            var currentTheme = document.documentElement.getAttribute('data-theme') || 'dark';
            updateIcon(currentTheme);

            themeToggleBtn.addEventListener('click', function () {
                var nextTheme = (document.documentElement.getAttribute('data-theme') || 'dark') === 'dark' ? 'light' : 'dark';
                document.documentElement.setAttribute('data-theme', nextTheme);
                localStorage.setItem('theme', nextTheme);
                updateIcon(nextTheme);
            });
        })();

        // Dynamic rotating taglines for India SME problems
        (function () {
            var taglines = [
                "✨ Track customer dues with voice—no more ledger books.",
                "✨ Send payment reminders in seconds—your voice, their WhatsApp.",
                "✨ Know who owes what, instantly—just ask in Hindi or English.",
                "✨ Generate invoices while you work—speak, don't type.",
                "✨ Never forget a collection—AI remembers every pending payment.",
                "✨ Manage inventory by voice—perfect for busy shop owners.",
                "✨ Your personal business assistant—built for Indian SMEs.",
                "✨ Stop chasing payments manually—automate with your voice.",
                "✨ Real-time business insights—no spreadsheets, just conversations.",
                "✨ From kirana to retail—voice-first business management."
            ];

            var taglineElem = document.getElementById('dynamicTagline');
            if (!taglineElem) return;

            var currentIndex = 0;

            function updateTagline() {
                taglineElem.style.opacity = '0';
                
                setTimeout(function () {
                    currentIndex = (currentIndex + 1) % taglines.length;
                    taglineElem.textContent = taglines[currentIndex];
                    taglineElem.style.opacity = '1';
                }, 400);
            }

            // Set initial tagline
            taglineElem.textContent = taglines[0];
            taglineElem.style.opacity = '1';

            // Rotate every 4 seconds
            setInterval(updateTagline, 4000);
        })();
    </script>

    <!-- UI Switcher Script -->
    <script>
        (function() {
            const uiSwitcherBtn = document.getElementById('uiSwitcherBtn');
            if (uiSwitcherBtn) {
                uiSwitcherBtn.addEventListener('click', function() {
                    localStorage.setItem('execora-ui-version', 'stable');
                    window.location.href = '/index-audio-stable.html';
                });
            }
        })();
    </script>

    <script src="/js/app-audio.js"></script>
</body>
</html>







